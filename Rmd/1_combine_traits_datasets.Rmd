---
title: "CCA phyloGWAS Eucalyptus species traits coordination"
author: "Anne-Cecile Colin"
date: "10/06/2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
library(tidyverse)
library(devtools)
```

## Combining delta(13)C with the big species dataset

script to combine the previous dataset with species functional traits to the d13C dataset
the two datasets are combined according to the unique RowTree ID
then the dataset is filtered by unique RowTree# just in case.

```{r combine datasets}
d13C_data <- read.csv2("data/d13C_data.csv", header = TRUE)
view(d13C_data)

species_dataset <- read.csv("data/species_dataset.csv", header = TRUE)
view(species_dataset)

full.df <- left_join(d13C_data, species_dataset, by = c("RowTree"))
view(full.df)

u_full.df<-
  full.df %>% distinct(RowTree, .keep_all = T)

write.csv(u_full.df, "outputs/species_functional_traits.csv")

```

## Selecting/filtering the dataset for specific species/year

Because the whole d13C dataset contains also Victoria's species I refine here to exclude other species in Maidenaria or Eucalyptus sections.

``` {refine species selection}

cca_filtered <- 
  u_full.df %>% 
  filter(Section %in% c("Exsertaria", "Adnataria"),
         between(year, 1994, 2001))
view(cca_filtered)
```

## Plotting species trait data

Then we can plot traits against each other:
``` {plotting d13C against MAP}

plot.map.d13c <- ggplot(data = cca_filtered, mapping = aes(x = BIO1, y = d13C)) + 
  geom_point(mapping = aes(color = sections))+
  facet_grid(Section ~ .)

print(plot.map.d13c)
dev.print(pdf, 'plots/plot_d13C_MAP_sections.pdf')
```


``` {plotting d13C against latitude of tree's homesite}
plot.map.latitude <- ggplot(data = cca_filtered, mapping = aes(x = latitude, y = d13C)) + 
  geom_point(mapping = aes(color = sections))+
  facet_grid(Section ~ .)

print(plot.map.latitude)
dev.print(pdf, 'plots/plot_d13C_latitude_sections.pdf')

```

``` {plotting d13C against AI}
plot.map.latitude <- ggplot(data = cca_filtered, mapping = aes(x = AI, y = d13C)) + 
  geom_point(mapping = aes(color = sections))+
  facet_grid(Section ~ .)

print(plot.map.AI)
dev.print(pdf, 'plots/plot_d13C_aridityindex_sections.pdf')
```
